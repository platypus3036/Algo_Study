name: Generate Daily Study Template

on:
  workflow_dispatch:
    inputs:
      date:
        description: '폴더 이름으로 사용할 날짜 (yymmdd 형식)'
        required: true
      problems:
        description: '문제와 링크 목록 (형식: 문제이름1:링크1,문제이름2:링크2)'
        required: true
        default: '문제A:https://example.com/problem/1,문제B:https://example.com/problem/2'

jobs:
  generate-files:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Create study template
        run: |
          TARGET_DATE="${{ github.event.inputs.date }}"
          # --- 바로 이 부분입니다! ---
          # 입력받은 값을 쌍따옴표로 감싸서 띄어쓰기가 포함된 문자열도 안전하게 처리합니다.
          PROBLEM_LIST="${{ github.event.inputs.problems }}"
          
          mkdir -p "$TARGET_DATE"
          
          # README 파일 내용 생성 (이후 로직은 동일)
          README_CONTENT=$(cat <<-EOF
          # 🗓️ ${TARGET_DATE} 스터디 회고
          # ... (이하 생략) ...
          EOF
          )
          
          IFS=',' read -ra PROBLEMS_ARRAY <<< "$PROBLEM_LIST"

          for item in "${PROBLEMS_ARRAY[@]}"; do
            PROBLEM_NAME="${item%%:*}"
            PROBLEM_LINK="${item#*:}"
            PROBLEM_NAME=$(echo "$PROBLEM_NAME" | sed 's/^[ \t]*//;s/[ \t]*$//')
            
            README_CONTENT+=$(cat <<-EOM

          ### 📝 ${PROBLEM_NAME}
          - **문제 링크**: [바로가기](${PROBLEM_LINK})
          - **난이도**: 
          - **주요 접근법 요약**: 
          - **토론 내용 및 피드백**: 
          EOM
          )
          done
          
          # ... (이후 KPT, 다음 주 계획 추가 로직 생략) ...

          echo "$README_CONTENT" > "${TARGET_DATE}/README.md"
          
      - name: Commit and push changes
        # ... (커밋 및 푸시 로직은 동일) ...
