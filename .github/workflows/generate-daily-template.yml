# .github/workflows/generate-daily-template.yml

name: Generate Daily Study Template

on:
  workflow_dispatch:
    inputs:
      date:
        description: 'í´ë” ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•  ë‚ ì§œ (yymmdd í˜•ì‹)'
        required: true
        default: $(date +'%y%m%d')
      problems_info:
        description: "ë¬¸ì œ ì •ë³´ë¥¼ 'ì´ë¦„|ë§í¬|ë‚œì´ë„' í˜•ì‹ìœ¼ë¡œ, ë¬¸ì œ ê°„ì—ëŠ” ì„¸ë¯¸ì½œë¡ (;)ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥"
        required: true
        default: 'A+B|https://...|Bronze; ë¬¸ì œì´ë¦„2|https://...|Gold'

jobs:
  generate-files:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Create Common Study Template
        run: |
          TARGET_DATE=${{ github.event.inputs.date }}
          PROBLEMS_INPUT=${{ github.event.inputs.problems_info }}

          # 1. ë‚ ì§œ í´ë” ìƒì„± ë° ê¸°ë³¸ README íŒŒì¼ ìƒì„±
          mkdir -p "$TARGET_DATE"
          cat <<EOF > "${TARGET_DATE}/README.md"
# ğŸ—“ï¸ ${TARGET_DATE} ìŠ¤í„°ë”” íšŒê³ 

## ğŸ¯ ì´ë²ˆ ì£¼ ìŠ¤í„°ë”” ëª©í‘œ ë° ì£¼ìš” í•™ìŠµ ë‚´ìš©

- 

---

## ğŸ“š ë¬¸ì œë³„ í† ë¡  ë° íšŒê³ 

EOF

          # 2. ì„¸ë¯¸ì½œë¡ (;)ìœ¼ë¡œ ê° ë¬¸ì œ ì •ë³´ë¥¼ ë¶„ë¦¬í•˜ì—¬ ë°°ì—´ë¡œ ë§Œë“¦
          IFS=';' read -ra PROBLEMS_ARRAY <<< "$PROBLEMS_INPUT"
          
          # 3. ê° ë¬¸ì œ ì •ë³´ë¥¼ ìˆœíšŒí•˜ë©° ì²˜ë¦¬
          for problem_info in "${PROBLEMS_ARRAY[@]}"; do
            # 4. íŒŒì´í”„(|)ë¡œ ì´ë¦„, ë§í¬, ë‚œì´ë„ë¥¼ ë‹¤ì‹œ ë¶„ë¦¬
            IFS='|' read -r name link difficulty <<< "$problem_info"
            
            # ì•ë’¤ ê³µë°± ì œê±°
            name=$(echo "$name" | xargs)
            link=$(echo "$link" | xargs)
            difficulty=$(echo "$difficulty" | xargs)

            # 5. ë‚ ì§œë³„ README íŒŒì¼ì— í…œí”Œë¦¿ ì¶”ê°€
            cat <<EOM >> "${TARGET_DATE}/README.md"

### ğŸ“ [${name}](${link})

- **ë‚œì´ë„**: ${difficulty}
- **ì£¼ìš” ì ‘ê·¼ë²• ìš”ì•½**: (ì˜ˆ: AëŠ” DFS, BëŠ” DPë¡œ ì ‘ê·¼)
- **í† ë¡  ë‚´ìš© ë° í”¼ë“œë°±**: (ì˜ˆ: ì‹œê°„ ë³µì¡ë„ ê°œì„  ë°©ì•ˆ, ì½”ë“œ ê°€ë…ì„± ë…¼ì˜)

EOM
          done
          
          # 6. KPT íšŒê³  ë° ë‹¤ìŒ ì£¼ ê³„íš ì„¹ì…˜ì„ READMEì— ì¶”ê°€
          cat <<EOF >> "${TARGET_DATE}/README.md"

---

## ğŸš€ KPT íšŒê³  (Keep, Problem, Try)

### Keep (ìœ ì§€í•  ì )

- 

### Problem (ê°œì„ í•  ì )

- 

### Try (ë‹¤ìŒì— ì‹œë„í•  ì )

- 

---

## ğŸ—“ï¸ ë‹¤ìŒ ì£¼ ê³„íš

- 
EOF

      - name: Commit and Push changes
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add .
          git commit -m "docs: ${TARGET_DATE} ìŠ¤í„°ë”” íšŒê³  í…œí”Œë¦¿ ìƒì„±" || exit 0
          git push
