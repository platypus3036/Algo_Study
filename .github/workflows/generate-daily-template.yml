name: Generate Daily Study Template

on:
  workflow_dispatch:
    inputs:
      date:
        description: 'í´ë” ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•  ë‚ ì§œ (yymmdd í˜•ì‹)'
        required: true
        default: "$(date +'%y%m%d')"
      problems:
        description: 'ë¬¸ì œì™€ ë§í¬ ëª©ë¡ (í˜•ì‹: ë¬¸ì œì´ë¦„1:ë§í¬1,ë¬¸ì œì´ë¦„2:ë§í¬2)'
        required: true
        default: 'ë¬¸ì œA:https://example.com/problem/1,ë¬¸ì œB:https://example.com/problem/2'

jobs:
  generate-files:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Create Common Study Template with Links
        run: |
          TARGET_DATE=${{ github.event.inputs.date }}
          PROBLEM_LIST=${{ github.event.inputs.problems }}

          mkdir -p "$TARGET_DATE"

          cat <<-EOF > "${TARGET_DATE}/README.md"
          # ğŸ—“ï¸ ${TARGET_DATE} ìŠ¤í„°ë”” íšŒê³ 

          ## ğŸ¯ ì´ë²ˆ ì£¼ ìŠ¤í„°ë”” ëª©í‘œ ë° ì£¼ìš” í•™ìŠµ ë‚´ìš©

          - 

          ---

          ## ğŸ“š ë¬¸ì œë³„ í† ë¡  ë° íšŒê³ 
          EOF

          # ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ëª©ë¡ì„ ë°°ì—´ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
          IFS=',' read -ra PROBLEMS_ARRAY <<< "$PROBLEM_LIST"

          for item in "${PROBLEMS_ARRAY[@]}"; do
            # ì•ë’¤ ê³µë°± ì œê±°
            trimmed_item=$(echo "$item" | xargs)
            
            # ':'ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¬¸ì œ ì´ë¦„ê³¼ ë§í¬ë¥¼ ë¶„ë¦¬í•©ë‹ˆë‹¤.
            # ë§í¬ì— ':'ê°€ í¬í•¨ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ(ì˜ˆ: https://...), ë‘ ë²ˆì§¸ í•„ë“œë¶€í„° ëê¹Œì§€ë¥¼ ë§í¬ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
            PROBLEM_NAME=$(echo "$trimmed_item" | cut -d':' -f1)
            PROBLEM_LINK=$(echo "$trimmed_item" | cut -d':' -f2-)
            
            cat <<-EOM >> "${TARGET_DATE}/README.md"

          ### ğŸ“ ${PROBLEM_NAME}

          - **ë¬¸ì œ ë§í¬**: [ë°”ë¡œê°€ê¸°](${PROBLEM_LINK})
          - **ë‚œì´ë„**: 
          - **ì£¼ìš” ì ‘ê·¼ë²• ìš”ì•½**: (ì˜ˆ: AëŠ” DFS, BëŠ” DPë¡œ ì ‘ê·¼)
          - **í† ë¡  ë‚´ìš© ë° í”¼ë“œë°±**: (ì˜ˆ: ì‹œê°„ ë³µì¡ë„ ê°œì„  ë°©ì•ˆ, ì½”ë“œ ê°€ë…ì„± ë…¼ì˜)
          EOM
          done

          # KPT ë° ë‹¤ìŒ ì£¼ ê³„íš ì„¹ì…˜ ì¶”ê°€
          cat <<-EOF >> "${TARGET_DATE}/README.md"

          ---

          ## ğŸš€ KPT íšŒê³  (Keep, Problem, Try)

          ### Keep (ìœ ì§€í•  ì )

          - 

          ### Problem (ê°œì„ í•  ì )

          - 

          ### Try (ë‹¤ìŒì— ì‹œë„í•  ì )

          - 

          ---

          ## ğŸ—“ï¸ ë‹¤ìŒ ì£¼ ê³„íš

          - 
          EOF

      - name: Commit and Push changes
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add .
          git commit -m "docs: ${{ github.event.inputs.date }} ìŠ¤í„°ë”” íšŒê³  í…œí”Œë¦¿ ìƒì„±" || exit 0
          git push
